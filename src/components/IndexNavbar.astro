---
import { IndexNavData } from '../data/NavData';
---

<nav>
  <a href="/" class="logo">
    <img src="/assets/logo-white.png" alt="" class="logo-img" />
  </a>
  <ul>
    {
      IndexNavData.map(item => (
        <li>
          <a href={item.link}>{item.title}</a>
        </li>
      ))
    }

    <!--
              <li>
                  <a href="#appointments">
                      <button class="btn-primary">Contact</button>
                  </a>
              </li>
              -->
  </ul>
</nav>

<div class="navbar">
  <a href="/" class="logo">
    <img src="/assets/logo-white.png" alt="" class="mobile-logo-img" />
  </a>
  <div>
    <!-- <a href="#appointments">
                  <button class="btn-outline">Contact</button>
              </a> -->
    <div class="menu-icon">
      <div class="line"></div>
      <div class="line"></div>
      <div class="line"></div>
    </div>
  </div>
</div>

<div id="sidebar" style="width: 0%;">
  <div class="close"></div>
  <ul>
    {
      IndexNavData.map(item => (
        <li class="mobile-link">
          <a href={item.link}>{item.title}</a>
        </li>
      ))
    }
  </ul>

  <div class="buttons">
    <a href="./adults.html">
      <button class="btn-outline">Adults</button>
    </a>
    <a href="#appointments">
      <button class="btn-outline">Child and Adolescent</button>
    </a>
  </div>
</div>
<style lang="scss">
  @import '../styles/basic';
  @import '../styles/navbar';
</style>
<script>
  //NAVBAR

  const navbar = document.querySelector('nav') as HTMLElement;
  const header = document.querySelector('header') as HTMLElement;
  const logoImg = document.querySelector('.logo-img') as HTMLImageElement;

  const headerOptions = {
    rootMargin: '-100px 0px 0px 0px',
  };

  const headerObserver = new IntersectionObserver(function (entries, headerObserver) {
    entries.forEach(entry => {
      //console.log(entry.target)
      if (!entry.isIntersecting) {
        navbar.classList.add('navbar-scrolled');
        logoImg.src = '/assets/logo.png';
      } else {
        navbar.classList.remove('navbar-scrolled');
        logoImg.src = '/assets/logo-white.png';
      }
    });
  }, headerOptions);

  headerObserver.observe(header);

  //Mobile Navbar

  const mobileNavbar = document.querySelector('.navbar') as HTMLElement;
  const mobileLogoImg = document.querySelector('.mobile-logo-img') as HTMLImageElement;
  const mobileHeaderObserver = new IntersectionObserver(function (entries, mobileHeaderObserver) {
    entries.forEach(entry => {
      //console.log(entry.target)
      if (!entry.isIntersecting) {
        mobileNavbar.classList.add('navbar-mobile-scrolled');
        mobileLogoImg.src = '/assets/logo.png';
      } else {
        mobileNavbar.classList.remove('navbar-mobile-scrolled');
        mobileLogoImg.src = '/assets/logo-white.png';
      }
    });
  }, headerOptions);

  mobileHeaderObserver.observe(header);

  //Sidebar

  const menuIcon = document.querySelector('.menu-icon') as HTMLImageElement;
  const sideBar = document.querySelector('#sidebar') as HTMLElement;
  const closeIcon = document.querySelector('.close') as HTMLImageElement;

  menuIcon.addEventListener('click', () => {
    if (sideBar.style.width == '0%') {
      sideBar.style.width = '100%';
      sideBar.style.opacity = '1';
    } else {
      sideBar.style.opacity = '0';
    }
  });

  closeIcon.addEventListener('click', () => {
    if (sideBar.style.width == '100%') {
      sideBar.style.width = '0%';
      sideBar.style.opacity = '0';
    } else {
      sideBar.style.width = '100%';
      sideBar.style.opacity = '1';
    }
  });

  const mobileLinks = document.getElementsByClassName('mobile-link');

  for (var i = 0; i < mobileLinks.length; i++) {
    mobileLinks[i].addEventListener('click', () => {
      if (sideBar.style.width == '0%') {
        sideBar.style.width = '100%';
        sideBar.style.opacity = '1';
      } else {
        sideBar.style.opacity = '0';
      }
    });
  }
</script>
