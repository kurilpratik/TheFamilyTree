---
import { EmotionNavData } from '../data/NavData';
---

<nav>
  <a href="/emotion.html" class="logo">
    <img src="/assets/emotion-centre-logo-horizontal.png" alt="" class="logo-img" />
  </a>
  <ul>
    {
      EmotionNavData.map(item => (
        <li>
          <a href={item.link}>{item.title}</a>
        </li>
      ))
    }
  </ul>
</nav>

<div class="navbar">
  <a href="/emotion.html" class="logo">
    <img src="/assets/emotion-centre-logo-horizontal.png" alt="" class="mobile-logo-img" />
  </a>
  <ul>
    <li><a href="/index.html">{'< Family Tree'}</a></li>
  </ul>
</div>

<style lang="scss">
  @import '../styles/basic';
  @import '../styles/navbar';
  nav {
    z-index: 999;
    a {
      img {
        width: 180px !important;
      }
    }
  }
  .navbar {
    display: none;
    background-color: transparent;
    position: fixed;
    z-index: 100;
    width: 100%;
    padding-inline: 24px;
    padding-block: 12px;
    padding-block-end: 24px;
    height: 15vh;
    //top: 10%;//Only if we have a display bar else 0

    img {
      height: 42px;
    }
    ul {
      position: absolute;
      top: 37%;
      right: 5%;
      li {
        a {
          color: #fff;
          text-decoration: none;
        }
      }
      li:nth-child(1) {
        //margin-bottom: 1.5rem;
      }
    }
    button {
      //transform: scale(0.9);
    }
    .menu-icon {
      height: 28px;
      width: 42px;
      display: flex;
      margin-left: 20px;
      flex-direction: column;
      justify-content: space-between;

      .line {
        background-color: #fff;
        width: 100%;
        height: 4px;
        border-radius: 2px;
      }
    }
    @include mobile {
      display: block;
      display: flex;
    }
  }
  .navbar-mobile-scrolled {
    background: #fff !important;
    color: var(--primary);
    ul {
      position: relative;
      right: 0;
      top: 10%;
    }
    button {
      background-color: var(--emotion);
    }
  }
</style>

<script>
  //NAVBAR

  const navbar = document.querySelector('nav') as HTMLElement;
  const header = document.querySelector('header') as HTMLElement;
  const logoImg = document.querySelector('.logo-img') as HTMLImageElement;

  const headerOptions = {
    rootMargin: '-100px 0px 0px 0px',
  };

  const headerObserver = new IntersectionObserver(function (entries, headerObserver) {
    entries.forEach(entry => {
      //console.log(entry.target)
      if (!entry.isIntersecting) {
        navbar.classList.add('navbar-scrolled');
        logoImg.src = '/assets/emotion-centre-logo-horizontal-red.png';
      } else {
        navbar.classList.remove('navbar-scrolled');
        logoImg.src = '/assets/emotion-centre-logo-horizontal.png';
      }
    });
  }, headerOptions);

  headerObserver.observe(header);

  //Mobile Navbar

  const mobileNavbar = document.querySelector('.navbar') as HTMLElement;
  const mobileLogoImg = document.querySelector('.mobile-logo-img') as HTMLImageElement;
  const mobileHeaderObserver = new IntersectionObserver(function (entries, mobileHeaderObserver) {
    entries.forEach(entry => {
      //console.log(entry.target)
      if (!entry.isIntersecting) {
        mobileNavbar.classList.add('navbar-mobile-scrolled');
        mobileLogoImg.src = '/assets/emotion-centre-logo-horizontal-red.png';
      } else {
        mobileNavbar.classList.remove('navbar-mobile-scrolled');
        mobileLogoImg.src = '/assets/emotion-centre-logo-horizontal.png';
      }
    });
  }, headerOptions);

  mobileHeaderObserver.observe(header);
</script>
